<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Randomized Quadrature Rules for Trunk Spaces</title>
		<meta name="author" content="T. Teijeiro">

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/bcam.css">

		<link rel='shortcut icon' type='image/x-icon' href='images/favicon.ico' />

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<!--Title-->
                <section style="height:100%" data-transition="none" data-background-image="images/background_titlepage.svg">
                    <h2 style="margin-top:5%;margin-bottom:6%">Generating Efficient Randomized Quadrature Rules for 2D and 3D Trunk Spaces using Machine Learning</h2>
                    <h4 style="color:#222;margin-bottom:8%"><em>Tomas Teijeiro</em>, David Pardo, Victor Calo</h2>
                    <h4 style="text-align:left;color:#222;font-size:1.3em;margin-bottom:1%">ECCOMAS 2024</h4>
                    <h5 style="text-align:left;color:#222;font-size:0.8em">06/06/2024, Lisboa</h5>
                    <img class="plain" style="position:fixed;left:0;bottom:5%;height:8%" src="images/institutional_logos.png"/>
                    <img class="plain" style="position:fixed;right:0;bottom:5%;height:8%" src="images/bottom_right_titlepage.png"/>
                </section>

                <!--Outline-->
                <section>
                    <h2>Outline</h2>
                    <ol class="outline">
                        <li>Motivation</li>
                        <li>Trunk Spaces</li>
                        <li>Finding Quadratures: An Optimization Problem</li>
                        <li>Machine Learning Algorithm</li>
                        <li>Results and Conclusion</li>
                    </ol>
                </section>

				<section>
					<h2>Motivation</h2>
					<ul style="margin-bottom:1em">
						<li class="fragment fade-in" data-fragment-index="1">In FEM, integration rules for higher-dimensional spaces are usually built by means of <b>tensor products over 1D</b> rules.</li>
						<li style="width:70%" class="fragment fade-in" data-fragment-index="2">This leads to <b>spaces larger than necessary</b> <div class="fragment fade-in" data-fragment-index="3"> â†’ increased computational complexity.</div></li>
						<li style="width:68%" class="fragment fade-in" data-fragment-index="4"><em>Can we optimize the complexity of the spaces, and then find simpler and more efficient rules?</em></li>
					</ul>
					<img style="position:absolute;bottom:2%;right:3%;width:27%" class="plain fragment fade-up" data-fragment-index="3" src="images/npoints_gauss.svg"/>
				</section>

				<section>
					<section>
						<h2>Trunk Spaces</h2>
						<p>A popular simplification of product spaces in FEM are <b>trunk spaces</b>, also called "serendipity" spaces. For example, in 2D, the simplest formulation given the maximum degree in 1D ($p$) is the set of polynomial spaces spanned by $x^iy^j, i,j = 0,1,\ldots,p$ subject to the <b>restriction</b> $i+j\leq~p$.</p>
						<div class="fragment fade-in" data-fragment-index="1">
							<div>$1$</div>
							<div>$x\quad~y$</div>
							<div>$x^2\quad~xy\quad~y^2$</div>
							<div class="fragment semi-fade-out" data-fragment-index="2">$x^2y\quad~xy^2$</div>
							<div class="fragment semi-fade-out" data-fragment-index="2">$x^2y^2$</div>
						</div>
						<div style="position:absolute;left:0;right:0;margin-left:auto;margin-top:0.5em" class="fragment current-visible" data-fragment-index="1">
                                2D Tensor Product space for $p=2$
						</div>
						<div style="position:absolute;left:0;right:0;margin-left:auto;margin-top:0.5em" class="fragment current-visible" data-fragment-index="2">
                                2D Trunk space for $p=2$
						</div>
					</section>

					<section data-auto-animate>
						<h3>Lowering the condition number</h3>
						<ul>
							<li class="fragment fade-in" class="fragment fade-in" data-fragment-index="1">Function spaces built on product of monomials lead to <b>high condition numbers</b>.</li>
							<li class="fragment fade-in" class="fragment fade-in" data-fragment-index="2">We implemented the 2D and 3D target spaces as products of 1D <em>hierarchic shape functions</em>:</li>
						</ul>
						<div data-id="eqs" style="font-size:12pt" class="fragment fade-in" data-fragment-index="3">
						$$
						\begin{aligned}
							N_1(x) &amp; = \frac{1-x}{2}\\
							N_2(x) &amp; = \frac{1+x}{2}\\
							N_i(x) &amp; = \phi_{i-1}(x),~i=3,4,\ldots,p+1
						\end{aligned}
						$$
						</div>
						<p style="text-align:left;font-size:0.5em" class="fragment fade-in" data-fragment-index="3">with:</p>
						<div data-id="phi" style="font-size:10pt" class="fragment fade-in" data-fragment-index="3">
						\[
\begin{equation*}
\phi_j(x) = \frac{1}{\sqrt{4j - 2}} (P_j(x) - P_{j-2}(x)), \quad j = 2, 3, \ldots
\end{equation*}
						\]
						</div>
						<p style="text-align:left;font-size:0.5em" class="fragment fade-in" data-fragment-index="3">where $P_j(x)$ are Legendre polynomials.</p>

					</section>

					<section data-auto-animate>
						<h3>Lowering the condition number</h3>
						<ul>
							<li>Function spaces built on product of monomials lead to <b>high condition numbers</b>.</li>
							<li>We implemented the 2D and 3D target spaces as products of 1D <em>hierarchic shape functions</em>:</li>
						</ul>

							<img style="float:right;margin-right:15%;width:30%" src="images/1D_space_p6.svg"/>
							<div data-id="eqs" style="font-size:12pt;max-width:50%">
								$$
								\begin{aligned}
									N_1(x) &amp; = \frac{1-x}{2}\\
									N_2(x) &amp; = \frac{1+x}{2}\\
									N_i(x) &amp; = \phi_{i-1}(x),~i=3,4,\ldots,p+1
								\end{aligned}
								$$
							</div>
								<p style="text-align:left;font-size:0.5em;max-width:50%">with:</p>
							<div data-id="phi" style="font-size:10pt;max-width:50%">
								\[
		\begin{equation*}
		\phi_j(x) = \frac{1}{\sqrt{4j - 2}} (P_j(x) - P_{j-2}(x)), \quad j = 2, 3, \ldots
		\end{equation*}
								\]
							</div>
							<p style="text-align:left;font-size:0.5em;max-width:30%">where $P_j(x)$ are Legendre polynomials.</p>
					</section>

					<section>
						<h3>Target spaces for integration</h3>
						<ul>
							<li class="fragment fade-in">Given the maximum degree $p$ of the basis functions in 1D, we define the trial and test spaces $U$ and $V$ as 2D or 3D trunk spaces of degree $p$.</li>
							<li class="fragment fade-in">Our target space for integration will be $\mathcal{S} = U \otimes V$.</li>
							<li class="fragment fade-in">However, products of trunk spaces <em>are not trunk spaces</em> ðŸ˜­. </li>
							<li class="fragment fade-in">Still, target spaces are <em>smaller</em> than regular tensor-product spaces. <b class="fragment fade-in">Can we go beyond Gaussian quadrature rules for integration?</b></li>
						</ul>
					</section>
				</section>

				<section>
					<section><h2>Finding Quadrature Rules:<br/> An Optimization Problem</h2></section>

					<section>
						<h3>Quadrature rules: Parameterization</h3>
						<p>In 2D, an exact quadrature rule for $\mathcal{S}$ is given by ${X := \{x_i\}_{i=1}^q}$, ${Y := \{y_i\}_{i=1}^q}$ and ${W := \{w_i\}_{i=1}^q}$, such that:</p>
						<div class="fragment fade-in" data-fragment-index="1">
						$$
						\begin{equation}
						\iint \limits_{0}^{1} f(x, y) dx~dy = \sum\limits_{i=1}^q f(x_i,y_i)w_i ~ \forall f \in \mathcal{S}
						\end{equation}
						$$
						</div>
						<p class="fragment fade-in" data-fragment-index="2">Thus, we seek to find $q, X, Y$ (and ${Z := \{z_i\}_{i=1}^q}$ for 3D spaces) such that $q$ <b>is minimum</b> and $(1)$ is satisfied. <span class="fragment fade-in" data-fragment-index="3">We have also the following constraints:</span></p>
						<div style="font-size:0.6em" class="fragment fade-in" data-fragment-index="3">
						$$
						\begin{aligned}
						x_i, y_i, z_i, w_i &amp;\in [0, 1]\,,\quad i=1,2,\ldots,q\,,\\
						\sum\limits_{i=1}^q w_i &amp;= 1\,.
						\end{aligned}
						$$
						</div>
					</section>

					<section>
						<h3>Target Loss Function</h3>

						<p>Given the set of basis functions $\{v_i(x,y)\}_{i=1}^n$ of $\mathcal{S}$, the two main components of our loss function are:</p>
						<div class="column-container">
							<div class="fragment fade-right">
							<h5 style='color:#222;font-size:0.8em'>Gram matrix</h5>
								<div style="font-size:0.6em">
									$M_{ij} :=\iint \limits_0^1 v_i v_j dx dy , \quad i,j=1,\ldots, n$
								</div>
							</div>
							<div class="fragment fade-left">
							<h4 style='color:#222;font-size:0.8em'>Individual integration error</h4>
								<div style="font-size:0.6em">
									$e(v_i) := \left|\iint \limits_{0}^{1}v_i(x,y) dx dy - \sum\limits_{j=1}^q v_i(x_j,y_j)w_j\right|$
								</div>
							</div>
						</div>

						<div class="fragment fade-in">
							<p>then, the loss function is defined as:</p>
							<div style="font-size:0.9em">
							$$
							L(X, W) := \max\limits_{f\in \mathcal{S}}\frac{\left|e(f)\right|}{||f||_{L^2}}=\left(\sum\limits_{i,j=0}^n (M^{-1})_{ij}e(v_i)e(v_j)\right)^\frac{1}{2}

							$$
							</div>
						</div>

					</section>
				</section>

				<section>
					<section><h2>Machine Learning Algorithm</h2></section>
					<section>Slide 2</section>
				</section>

				<section>
					<section><h2>Results and Conclusion</h2></section>
					<section>Slide 2</section>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="plugin/math/math.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX ]
			});
		</script>
	</body>
</html>
